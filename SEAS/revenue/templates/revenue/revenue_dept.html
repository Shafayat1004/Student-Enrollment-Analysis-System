{% extends 'base.html' %}
{% block title %}Revenue of Departments{% endblock title %}

{% block content %}
	<div>
		<h1>Department-wise Revenue of {{schoolSelected}}</h1>
		<canvas id="schoolRevTrendChart"></canvas> 
		<h1>Revenue Distribution among {{schoolSelected}} Departments</h1>
		<canvas id="schoolRevDistChart"></canvas>

		<script>
			let ctx1 = document.getElementById("schoolRevTrendChart").getContext("2d");
            let ctx2 = document.getElementById("schoolRevDistChart").getContext("2d");

			let chartX = [ {% for semester in xAxis %} '{{semester}}', {% endfor %} ];

			let chart1_Y = [ 
                {% for key in yAxis %} 
                {
                    label: '{{key.label}}',
                    data: [ {% for rev in key.data %} {{rev}}, {% endfor %} ],
                    borderColor: '{{key.borderColor}}',
                    fill: false
                },
                {% endfor %}
            ]

			const chartTrend = new Chart( ctx1, {
					type: "line",
					data: {
						labels:   chartX,
						datasets: chart1_Y
					},
					options: {
						responsive: true,
						title: {
							text: "Revenue Trend of Departments",
							display: true,
							padding: {
								top: 10,
								bottom: 30
							}
						}
					}
				}          
			);

			let chart2_Y = [ 
				{% for key in yAxis %} 
				{
					label: '{{key.label}}',
					data: [ {% for rev in key.data %} {{rev}}, {% endfor %} ],
					borderColor: '{{key.borderColor}}',
					backgroundColor: '{{key.borderColor}}',
					fill: true
				},
				{% endfor %}
			]

			const chartDist = new Chart( ctx2, {
					type: "line",
					data: {
						labels:   chartX,
						datasets: chart2_Y
					},
					options: {
						responsive: true,
						title: {
							text: 'Revenue Distribution among Departments',
							display: true,
							padding: {
								top: 10,
								bottom: 30
							}
						},
						scales: {
							y: { stacked: 'single' }
						}
					}
				}          
			);


		</script>		
	</div>

	<table class='table'>
		<thead>
			<tr><th colspan="10" style="text-align:center">Historical Revenue Data of {{schoolSelected}}</th></tr>
		</thead>
		<thead>
			<tr>
				{% for colName in colNames %}​
				<th>​{{colName}}​</th>
				​{% endfor %} 
			​</tr> 
		</thead>
		<tbody>
			{% for row in revenues %} 
			<tr>
				{% for item in row %}
				<td>​{{item}}​</td> 
				{% endfor %}
			</tr>
			{% endfor %}
		</tbody> 
	</table>
</div>
{% endblock content %}